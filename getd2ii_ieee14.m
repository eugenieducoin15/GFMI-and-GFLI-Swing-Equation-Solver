function d2ii_gfl = getd2ii_ieee14(n_gfm, n_gfl, x, dx, B, num2_denom2, mp, kp, ki, dz, w, V)

    dc1 = sym('dc1');
    dc2 = sym('dc2');
    dc3 = sym('dc3');
    dc4 = sym('dc4');
    dc5 = sym('dc5');
    dc6 = sym('dc6');
    dc7 = sym('dc7');
    dc8 = sym('dc8');
    dc9 = sym('dc9');
    dc10 = sym('dc10');
    dc11 = sym('dc11');
    dc12 = sym('dc12');
    dc13 = sym('dc13');
    dc14 = sym('dc14');
    temp_dc = [dc1 dc2 dc3 dc4 dc5 dc6 dc7 dc8 dc9 dc10 dc11 dc12 dc13 dc14];
    iic1 = sym('iic1');
    iic2 = sym('iic2');
    iic3 = sym('iic3');
    iic4 = sym('iic4');
    iic5 = sym('iic5');
    iic6 = sym('iic6');
    iic7 = sym('iic7');
    iic8 = sym('iic8');
    iic9 = sym('iic9');
    iic10 = sym('iic10');
    iic11 = sym('iic11');
    iic12 = sym('iic12');
    iic13 = sym('iic13');
    iic14 = sym('iic14');
    temp_iic = [iic1 iic2 iic3 iic4 iic5 iic6 iic7 iic8 iic9 iic10 iic11 iic12 iic13 iic14];
    dd1 = sym('dd1');
    dd2 = sym('dd2');
    dd3 = sym('dd3');
    dd4 = sym('dd4');
    dd5 = sym('dd5');
    dd6 = sym('dd6');
    dd7 = sym('dd7');
    dd8 = sym('dd8');
    dd9 = sym('dd9');
    dd10 = sym('dd10');
    dd11 = sym('dd11');
    dd12 = sym('dd12');
    dd13 = sym('dd13');
    dd14 = sym('dd14');
    temp_dd = [dd1 dd2 dd3 dd4 dd5 dd6 dd7 dd8 dd9 dd10 dd11 dd12 dd13 dd14];
    dii1 = sym('dii1');
    dii2 = sym('dii2');
    dii3 = sym('dii3');
    dii4 = sym('dii4');
    dii5 = sym('dii5');
    dii6 = sym('dii6');
    dii7 = sym('dii7');
    dii8 = sym('dii8');
    dii9 = sym('dii9');
    dii10 = sym('dii10');
    dii11 = sym('dii11');
    dii12 = sym('dii12');
    dii13 = sym('dii13');
    dii14 = sym('dii14');
    temp_dii = [dii1 dii2 dii3 dii4 dii5 dii6 dii7 dii8 dii9 dii10 dii11 dii12 dii13 dii14];
    d2d1 = sym('d2d1');
    d2d2 = sym('d2d2');
    d2d3 = sym('d2d3');
    d2d4 = sym('d2d4');
    d2d5 = sym('d2d5');
    d2d6 = sym('d2d6');
    d2d7 = sym('d2d7');
    d2d8 = sym('d2d8');
    d2d9 = sym('d2d9');
    d2d10 = sym('d2d10');
    d2d11 = sym('d2d11');
    d2d12 = sym('d2d12');
    d2d13 = sym('d2d13');
    d2d14 = sym('d2d14');
    temp_d2d = [d2d1 d2d2 d2d3 d2d4 d2d5 d2d6 d2d7 d2d8 d2d9 d2d10 d2d11 d2d12 d2d13 d2d14];
    d2ii1 = sym('d2ii1');
    d2ii2 = sym('d2ii2');
    d2ii3 = sym('d2ii3');
    d2ii4 = sym('d2ii4');
    d2ii5 = sym('d2ii5');
    d2ii6 = sym('d2ii6');
    d2ii7 = sym('d2ii7');
    d2ii8 = sym('d2ii8');
    d2ii9 = sym('d2ii9');
    d2ii10 = sym('d2ii10');
    d2ii11 = sym('d2ii11');
    d2ii12 = sym('d2ii12');
    d2ii13 = sym('d2ii13');
    d2ii14 = sym('d2ii14');
    temp_d2ii = [d2ii1 d2ii2 d2ii3 d2ii4 d2ii5 d2ii6 d2ii7 d2ii8 d2ii9 d2ii10 d2ii11 d2ii12 d2ii13 d2ii14];

A = eye(n_gfl);
for i_de = n_gfm+1:n_gfm+n_gfl
    [temp1,~]=coeffs(vpa(subs(num2_denom2(i_de),[temp_dd(1:n_gfm) temp_dii(n_gfm+1:n_gfm+n_gfl) temp_dc(1:n_gfm) temp_iic(n_gfm+1:n_gfm+n_gfl) temp_d2d(1:n_gfm)],[x(1:end-1)' dx(1:n_gfm)'])),temp_d2ii(n_gfm+1:n_gfm+n_gfl)); 
    temp1 = [double(temp1) zeros(1,n_gfl+1-length(temp1))];
    A(i_de-n_gfm,:) = A(i_de-n_gfm,:) + mp(i_de)/(V(i_de)*cos(dz(i_de)))*kp(i_de)*temp1(1:n_gfl);
    B(i_de-n_gfm) = B(i_de-n_gfm) - mp(i_de)/(V(i_de)*cos(dz(i_de)))*(kp(i_de)*temp1(end) + ki(i_de)*w(i_de)) - kp(i_de)*x(i_de) - ki(i_de)*x(n_gfm+n_gfl+i_de);
end
d2ii_gfl = linsolve(A,B);

%    d2ii_gfl = vpa(subs(d2ii_sym(bus-n_gfm),[temp_dd(1:n_gfm) temp_dii(n_gfm+1:n_gfm+n_gfl) temp_dc(1:n_gfm) temp_iic(n_gfm+1:n_gfm+n_gfl) temp_d2d(1:n_gfm)],[x(1:end-1)' dx(1:n_gfm)']));
end